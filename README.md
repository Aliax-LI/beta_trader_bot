# 配对交易机器人 (Pairs Trading Bot)

一个基于统计套利原理的自动化配对交易系统，专为加密货币市场设计。

## 📋 项目简介

本项目实现了一个完整的配对交易策略，基于统计套利和均值回归原理，在加密货币市场中寻找定价偏差并实现盈利。系统包含从数据获取、策略开发、回测验证到实盘交易的全套解决方案。

## ✨ 功能特性

### 核心功能
- 📊 **实时市场数据获取** - 支持多个交易所的实时数据流
- 🤖 **自动化配对交易** - 基于Z-score的智能交易决策
- 📈 **完整回测框架** - 基于Backtrader的全面回测系统
- 🎯 **动态风险管理** - 多层次风险控制和资金管理
- 📱 **实时监控面板** - 可视化策略表现和系统状态
- 🔔 **智能警报系统** - 关键事件实时通知

### 技术特性
- ⚡ **高性能架构** - 异步IO和并发处理
- 🔧 **模块化设计** - 易于扩展和维护
- 📝 **完整日志系统** - 详细的运行日志和审计跟踪
- 🧪 **全面测试覆盖** - 单元测试和集成测试
- 🔒 **安全可靠** - 安全的API密钥管理和错误处理

## 🚀 快速开始

### 环境要求

- Python 3.8+
- 支持的交易所账户（Binance、OKX等）
- 稳定的网络连接

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd beta_trader_bot
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **环境配置**
创建 `.env` 文件，添加交易所API密钥：
```bash
BINANCE_API_KEY=your_api_key
BINANCE_SECRET_KEY=your_secret_key
BINANCE_SANDBOX=true
```

4. **配置调整**
编辑 `config/config.yaml` 文件，根据需求调整策略参数。

### 运行回测

```bash
# 运行基础回测
python run_backtest.py

# 运行指定配置的回测
python run_backtest.py --config config/config.yaml
```

### 启动实盘交易

```bash
# 启动交易机器人（测试模式）
python main.py --sandbox

# 启动交易机器人（实盘模式）
python main.py --live
```

## ⚙️ 配置说明

### 主配置 (config/config.yaml)

主要配置项包括：
- `strategy.pairs_trading`: 配对交易策略参数
- `backtest`: 回测配置
- `trading`: 交易配置

### 交易所配置 (config/exchanges.yaml)

配置支持的交易所和交易对。

### 配对配置 (config/pairs_config.yaml)

配置要交易的资产配对。

## 🧠 策略详解

### 配对选择算法

1. **相关性分析** - 计算资产间的价格相关性
2. **协整检验** - 验证长期均衡关系
3. **对冲比率计算** - 使用OLS回归确定最佳对冲比例

### 交易信号生成

基于Z-score的交易规则：
- Z-score > 入场阈值：做空价差
- Z-score < -入场阈值：做多价差
- |Z-score| < 出场阈值：平仓

### 风险管理

- **仓位控制** - 单次交易不超过总资金的10%
- **止损机制** - 基于Z-score的自动平仓
- **相关性监控** - 实时监控配对关系稳定性
- **资金管理** - 动态调整交易规模

## 📈 绩效指标

系统提供全面的绩效分析：
- **年化收益率** - 策略的年化回报率
- **夏普比率** - 风险调整后的收益
- **最大回撤** - 历史最大亏损幅度
- **胜率** - 盈利交易的比例
- **Calmar比率** - 收益与回撤的比率
- **交易次数** - 总交易数量统计

## ⚠️ 风险提示

### 市场风险
1. **关系破裂风险** - 资产相关性可能发生变化
2. **回归时间风险** - 价差可能长期不回归
3. **流动性风险** - 市场深度不足导致执行困难

### 技术风险
1. **网络延迟** - API调用延迟影响交易执行
2. **系统故障** - 硬件或软件故障导致交易中断
3. **API限制** - 交易所API调用频率限制

### 风险管理建议
- 始终在测试环境验证策略
- 从小资金开始实盘交易
- 设置严格的止损规则
- 分散投资多个不相关的配对
- 持续监控策略表现

## 🛠️ 开发指南

### 添加新策略
1. 继承 `BaseStrategy` 类
2. 实现 `calculate_signals` 方法
3. 在配置文件中添加策略参数
4. 编写单元测试

### 扩展新交易所
1. 在 `exchange_interface.py` 中添加支持
2. 更新 `exchanges.yaml` 配置
3. 测试API连接和功能

## 📝 许可证

本项目仅供学习和研究使用。使用本系统进行实盘交易的风险由用户自行承担。

## 🤝 贡献

欢迎提交Issue和Pull Request！

