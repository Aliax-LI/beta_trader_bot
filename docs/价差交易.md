# é…å¯¹äº¤æ˜“æœºå™¨äºº (Pairs Trading Bot)

ä¸€ä¸ªåŸºäºç»Ÿè®¡å¥—åˆ©åŸç†çš„è‡ªåŠ¨åŒ–é…å¯¹äº¤æ˜“ç³»ç»Ÿï¼Œä¸“ä¸ºåŠ å¯†è´§å¸å¸‚åœºè®¾è®¡ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„é…å¯¹äº¤æ˜“ç­–ç•¥ï¼ŒåŸºäºç»Ÿè®¡å¥—åˆ©å’Œå‡å€¼å›å½’åŸç†ï¼Œåœ¨åŠ å¯†è´§å¸å¸‚åœºä¸­å¯»æ‰¾å®šä»·åå·®å¹¶å®ç°ç›ˆåˆ©ã€‚ç³»ç»ŸåŒ…å«ä»æ•°æ®è·å–ã€ç­–ç•¥å¼€å‘ã€å›æµ‹éªŒè¯åˆ°å®ç›˜äº¤æ˜“çš„å…¨å¥—è§£å†³æ–¹æ¡ˆã€‚

### ğŸ¯ æ ¸å¿ƒåŸç†

é…å¯¹äº¤æ˜“åŸºäºä»¥ä¸‹æ•°å­¦åŸç†ï¼š

1. **å‡å€¼å›å½’**ï¼šç›¸å…³æ€§é«˜çš„èµ„äº§ä»·æ ¼ä¼šå›´ç»•å…¶é•¿æœŸå‡å€¼æ³¢åŠ¨
2. **åæ•´å…³ç³»**ï¼šä¸¤ä¸ªéå¹³ç¨³æ—¶é—´åºåˆ—çš„çº¿æ€§ç»„åˆå¯èƒ½æ˜¯å¹³ç¨³çš„
3. **ç»Ÿè®¡å¥—åˆ©**ï¼šåˆ©ç”¨èµ„äº§ä»·æ ¼çš„ç»Ÿè®¡å…³ç³»è€ŒéåŸºæœ¬é¢åˆ†æè·åˆ©

### ğŸ“Š ç­–ç•¥é€»è¾‘

```
ä»·æ ¼å…³ç³»åç¦» â†’ é¢„æœŸå›å½’ â†’ å»ºç«‹å¯¹å†²å¤´å¯¸ â†’ å…³ç³»å›å½’ â†’ å¹³ä»“è·åˆ©
```

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ“Š **å®æ—¶å¸‚åœºæ•°æ®è·å–** - æ”¯æŒå¤šä¸ªäº¤æ˜“æ‰€çš„å®æ—¶æ•°æ®æµ
- ğŸ¤– **è‡ªåŠ¨åŒ–é…å¯¹äº¤æ˜“** - åŸºäºZ-scoreçš„æ™ºèƒ½äº¤æ˜“å†³ç­–
- ğŸ“ˆ **å®Œæ•´å›æµ‹æ¡†æ¶** - åŸºäºBacktraderçš„å…¨é¢å›æµ‹ç³»ç»Ÿ
- ğŸ¯ **åŠ¨æ€é£é™©ç®¡ç†** - å¤šå±‚æ¬¡é£é™©æ§åˆ¶å’Œèµ„é‡‘ç®¡ç†
- ğŸ“± **å®æ—¶ç›‘æ§é¢æ¿** - å¯è§†åŒ–ç­–ç•¥è¡¨ç°å’Œç³»ç»ŸçŠ¶æ€
- ğŸ”” **æ™ºèƒ½è­¦æŠ¥ç³»ç»Ÿ** - å…³é”®äº‹ä»¶å®æ—¶é€šçŸ¥

### æŠ€æœ¯ç‰¹æ€§
- âš¡ **é«˜æ€§èƒ½æ¶æ„** - å¼‚æ­¥IOå’Œå¹¶å‘å¤„ç†
- ğŸ”§ **æ¨¡å—åŒ–è®¾è®¡** - æ˜“äºæ‰©å±•å’Œç»´æŠ¤
- ğŸ“ **å®Œæ•´æ—¥å¿—ç³»ç»Ÿ** - è¯¦ç»†çš„è¿è¡Œæ—¥å¿—å’Œå®¡è®¡è·Ÿè¸ª
- ğŸ§ª **å…¨é¢æµ‹è¯•è¦†ç›–** - å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ğŸ”’ **å®‰å…¨å¯é ** - å®‰å…¨çš„APIå¯†é’¥ç®¡ç†å’Œé”™è¯¯å¤„ç†

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
pairs_trading_project/
â”œâ”€â”€ config/                          # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ config.yaml                  # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ exchanges.yaml               # äº¤æ˜“æ‰€é…ç½®
â”‚   â””â”€â”€ pairs_config.yaml            # äº¤æ˜“å¯¹é…ç½®
â”œâ”€â”€ data/                            # æ•°æ®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ data_fetcher.py              # æ•°æ®è·å–ï¼ˆCCXTé›†æˆï¼‰
â”‚   â”œâ”€â”€ data_processor.py            # æ•°æ®å¤„ç†å’Œç‰¹å¾å·¥ç¨‹
â”‚   â”œâ”€â”€ database.py                  # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ historical_data.py           # å†å²æ•°æ®ç®¡ç†
â”œâ”€â”€ strategies/                      # ç­–ç•¥æ¨¡å—
â”‚   â”œâ”€â”€ base_strategy.py             # ç­–ç•¥åŸºç±»
â”‚   â”œâ”€â”€ pairs_trading.py             # é…å¯¹äº¤æ˜“ç­–ç•¥ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”œâ”€â”€ statistical_arbitrage.py     # ç»Ÿè®¡å¥—åˆ©ç­–ç•¥
â”‚   â””â”€â”€ risk_management.py           # é£é™©ç®¡ç†
â”œâ”€â”€ backtest/                        # å›æµ‹æ¨¡å—
â”‚   â”œâ”€â”€ backtest_engine.py           # å›æµ‹å¼•æ“ï¼ˆBacktraderï¼‰
â”‚   â”œâ”€â”€ performance.py               # ç»©æ•ˆåˆ†æ
â”‚   â””â”€â”€ visualization.py             # å¯è§†åŒ–
â”œâ”€â”€ trading/                         # äº¤æ˜“æ‰§è¡Œæ¨¡å—
â”‚   â”œâ”€â”€ exchange_interface.py        # äº¤æ˜“æ‰€æ¥å£ï¼ˆCCXTï¼‰
â”‚   â”œâ”€â”€ order_manager.py             # è®¢å•ç®¡ç†
â”‚   â”œâ”€â”€ position_manager.py          # ä»“ä½ç®¡ç†
â”‚   â””â”€â”€ execution_engine.py          # æ‰§è¡Œå¼•æ“
â”œâ”€â”€ monitoring/                      # ç›‘æ§æ¨¡å—
â”‚   â”œâ”€â”€ dashboard.py                 # ç›‘æ§é¢æ¿
â”‚   â”œâ”€â”€ alerts.py                    # è­¦æŠ¥ç³»ç»Ÿ
â”‚   â””â”€â”€ health_check.py              # å¥åº·æ£€æŸ¥
â”œâ”€â”€ utils/                           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ logger.py                    # æ—¥å¿—é…ç½®
â”‚   â”œâ”€â”€ helpers.py                   # è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ math_utils.py                # æ•°å­¦å·¥å…·
â”‚   â””â”€â”€ time_utils.py                # æ—¶é—´å·¥å…·
â”œâ”€â”€ tests/                           # æµ‹è¯•ç›®å½•
â”œâ”€â”€ docs/                            # æ–‡æ¡£
â”œâ”€â”€ scripts/                         # è„šæœ¬ç›®å½•
â”œâ”€â”€ logs/                            # æ—¥å¿—ç›®å½•
â”œâ”€â”€ requirements.txt                 # Pythonä¾èµ–
â”œâ”€â”€ main.py                          # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ run_backtest.py                  # å›æµ‹å…¥å£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- æ”¯æŒçš„äº¤æ˜“æ‰€è´¦æˆ·ï¼ˆBinanceã€OKXç­‰ï¼‰
- ç¨³å®šçš„ç½‘ç»œè¿æ¥

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/your-username/pairs-trading-bot.git
cd pairs-trading-bot
```

2. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

3. **ç¯å¢ƒé…ç½®**
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œæ·»åŠ äº¤æ˜“æ‰€APIå¯†é’¥
```

4. **é…ç½®è°ƒæ•´**
ç¼–è¾‘ `config/config.yaml` æ–‡ä»¶ï¼Œæ ¹æ®éœ€æ±‚è°ƒæ•´ç­–ç•¥å‚æ•°ã€‚

### è¿è¡Œå›æµ‹

```bash
# è¿è¡ŒåŸºç¡€å›æµ‹
python run_backtest.py

# è¿è¡ŒæŒ‡å®šé…ç½®çš„å›æµ‹
python run_backtest.py --config config/backtest_config.yaml

# è¿è¡Œå‚æ•°ä¼˜åŒ–
python run_backtest.py --optimize
```

### å¯åŠ¨å®ç›˜äº¤æ˜“

```bash
# å¯åŠ¨äº¤æ˜“æœºå™¨äººï¼ˆæµ‹è¯•æ¨¡å¼ï¼‰
python main.py --sandbox

# å¯åŠ¨äº¤æ˜“æœºå™¨äººï¼ˆå®ç›˜æ¨¡å¼ï¼‰
python main.py --live

# ä½¿ç”¨æŒ‡å®šé…ç½®æ–‡ä»¶
python main.py --config config/production.yaml
```

## âš™ï¸ é…ç½®è¯´æ˜

### ä¸»é…ç½® (config/config.yaml)

```yaml
app:
  name: "Pairs Trading Bot"
  version: "1.0.0"
  environment: "development"  # development, testing, production

strategy:
  pairs_trading:
    lookback_period: 60      # å›çœ‹æœŸï¼ˆæ•°æ®ç‚¹æ•°ï¼‰
    z_entry_threshold: 2.0   # å…¥åœºZ-scoreé˜ˆå€¼
    z_exit_threshold: 0.5    # å‡ºåœºZ-scoreé˜ˆå€¼
    position_size: 0.1       # ä»“ä½å¤§å°ï¼ˆæ€»èµ„é‡‘çš„10%ï¼‰
    max_position: 0.2        # æœ€å¤§ä»“ä½é™åˆ¶
    correlation_threshold: 0.8  # æœ€å°ç›¸å…³æ€§é˜ˆå€¼

backtest:
  initial_cash: 100000       # åˆå§‹èµ„é‡‘
  commission: 0.001          # äº¤æ˜“æ‰‹ç»­è´¹ï¼ˆ0.1%ï¼‰
  start_date: "2023-01-01"   # å›æµ‹å¼€å§‹æ—¥æœŸ
  end_date: "2023-12-31"     # å›æµ‹ç»“æŸæ—¥æœŸ

trading:
  enabled: false             # æ˜¯å¦å¯ç”¨å®ç›˜äº¤æ˜“
  sandbox: true              # æ˜¯å¦ä½¿ç”¨æµ‹è¯•ç¯å¢ƒ
  update_interval: 300       # æ•°æ®æ›´æ–°é—´éš”ï¼ˆç§’ï¼‰
```

### äº¤æ˜“æ‰€é…ç½® (config/exchanges.yaml)

```yaml
exchanges:
  binance:
    name: "Binance"
    enabled: true
    sandbox: true
    rate_limit: 1200
    timeout: 30000
    pairs:
      - "BTC/USDT"
      - "ETH/USDT"
      - "BNB/USDT"
```

## ğŸ§  ç­–ç•¥è¯¦è§£

### é…å¯¹é€‰æ‹©ç®—æ³•

1. **ç›¸å…³æ€§åˆ†æ** - è®¡ç®—èµ„äº§é—´çš„ä»·æ ¼ç›¸å…³æ€§
2. **åæ•´æ£€éªŒ** - éªŒè¯é•¿æœŸå‡è¡¡å…³ç³»
3. **å¯¹å†²æ¯”ç‡è®¡ç®—** - ä½¿ç”¨OLSå›å½’ç¡®å®šæœ€ä½³å¯¹å†²æ¯”ä¾‹

### äº¤æ˜“ä¿¡å·ç”Ÿæˆ

```python
# Z-scoreè®¡ç®—
spread = price_asset2 - hedge_ratio * price_asset1
z_score = (spread - spread_mean) / spread_std

# äº¤æ˜“è§„åˆ™
if z_score > z_entry:      # åšç©ºä»·å·®
    sell_asset2, buy_asset1
elif z_score < -z_entry:   # åšå¤šä»·å·®  
    buy_asset2, sell_asset1
elif abs(z_score) < z_exit: # å¹³ä»“
    close_positions
```

### é£é™©ç®¡ç†

- **ä»“ä½æ§åˆ¶** - å•æ¬¡äº¤æ˜“ä¸è¶…è¿‡æ€»èµ„é‡‘çš„10%
- **æ­¢æŸæœºåˆ¶** - åŸºäºZ-scoreçš„è‡ªåŠ¨å¹³ä»“
- **ç›¸å…³æ€§ç›‘æ§** - å®æ—¶ç›‘æ§é…å¯¹å…³ç³»ç¨³å®šæ€§
- **èµ„é‡‘ç®¡ç†** - åŠ¨æ€è°ƒæ•´äº¤æ˜“è§„æ¨¡

## ğŸ“ˆ ç»©æ•ˆæŒ‡æ ‡

ç³»ç»Ÿæä¾›å…¨é¢çš„ç»©æ•ˆåˆ†æï¼š

- **å¹´åŒ–æ”¶ç›Šç‡** - ç­–ç•¥çš„å¹´åŒ–å›æŠ¥ç‡
- **å¤æ™®æ¯”ç‡** - é£é™©è°ƒæ•´åçš„æ”¶ç›Š
- **æœ€å¤§å›æ’¤** - å†å²æœ€å¤§äºæŸå¹…åº¦
- **èƒœç‡** - ç›ˆåˆ©äº¤æ˜“çš„æ¯”ä¾‹
- **Calmaræ¯”ç‡** - æ”¶ç›Šä¸å›æ’¤çš„æ¯”ç‡
- **äº¤æ˜“æ¬¡æ•°** - æ€»äº¤æ˜“æ•°é‡ç»Ÿè®¡

## ğŸ”§ é«˜çº§åŠŸèƒ½

### å‚æ•°ä¼˜åŒ–
```bash
# ç½‘æ ¼æœç´¢ä¼˜åŒ–å‚æ•°
python scripts/optimize.py --param-grid config/optimization.yaml
```

### å®æ—¶ç›‘æ§
```bash
# å¯åŠ¨ç›‘æ§é¢æ¿
python monitoring/dashboard.py
```

### æ•°æ®å¯¼å‡º
```bash
# å¯¼å‡ºäº¤æ˜“è®°å½•
python scripts/export_trades.py --format csv
```

## âš ï¸ é£é™©æç¤º

### å¸‚åœºé£é™©
1. **å…³ç³»ç ´è£‚é£é™©** - èµ„äº§ç›¸å…³æ€§å¯èƒ½å‘ç”Ÿå˜åŒ–
2. **å›å½’æ—¶é—´é£é™©** - ä»·å·®å¯èƒ½é•¿æœŸä¸å›å½’
3. **æµåŠ¨æ€§é£é™©** - å¸‚åœºæ·±åº¦ä¸è¶³å¯¼è‡´æ‰§è¡Œå›°éš¾

### æŠ€æœ¯é£é™©
1. **ç½‘ç»œå»¶è¿Ÿ** - APIè°ƒç”¨å»¶è¿Ÿå½±å“äº¤æ˜“æ‰§è¡Œ
2. **ç³»ç»Ÿæ•…éšœ** - ç¡¬ä»¶æˆ–è½¯ä»¶æ•…éšœå¯¼è‡´äº¤æ˜“ä¸­æ–­
3. **APIé™åˆ¶** - äº¤æ˜“æ‰€APIè°ƒç”¨é¢‘ç‡é™åˆ¶

### é£é™©ç®¡ç†å»ºè®®
- å§‹ç»ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ç­–ç•¥
- ä»å°èµ„é‡‘å¼€å§‹å®ç›˜äº¤æ˜“
- è®¾ç½®ä¸¥æ ¼çš„æ­¢æŸè§„åˆ™
- åˆ†æ•£æŠ•èµ„å¤šä¸ªä¸ç›¸å…³çš„é…å¯¹
- æŒç»­ç›‘æ§ç­–ç•¥è¡¨ç°

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°ç­–ç•¥
1. ç»§æ‰¿ `BaseStrategy` ç±»
2. å®ç° `calculate_signals` æ–¹æ³•
3. åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ç­–ç•¥å‚æ•°
4. ç¼–å†™å•å…ƒæµ‹è¯•

### æ‰©å±•æ–°äº¤æ˜“æ‰€
1. åœ¨ `exchange_interface.py` ä¸­æ·»åŠ æ”¯æŒ
2. æ›´æ–° `exchanges.yaml` é…ç½®
3. æµ‹è¯•APIè¿æ¥å’ŒåŠŸèƒ½

### è‡ªå®šä¹‰æ•°æ®åˆ†æ
```python
from data.processor import DataProcessor
from strategies.base_strategy import BaseStrategy

class CustomStrategy(BaseStrategy):
    def calculate_signals(self, data):
        # å®ç°è‡ªå®šä¹‰ä¿¡å·é€»è¾‘
        pass
```
